@model MailViewModel
@{
    ViewData["Title"] = "Index";
}

<div id="mail-modal" class="modal fade" tabindex="-1" role="dialog"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="text-center mt-2 mb-4">
                </div>
                <div class="form-group">
                    <div class="custom-control custom-checkbox">
                        <label for="SelectAuth">Email</label>
                      <input type="text" id="mail" name="mail" />
                    </div>
                </div>

                <div class="form-group text-center">

                    <button class="btn btn-rounded btn-success" onclick= "BilgilendirmeEkle();"  type="submit">
                        Kaydet
                    </button>
                </div>
            </div>
        </div>
    </div><!-- /.modal -->
</div>
<div class="card">
    <div class="card-body">


        <form enctype="multipart/form-data" method="post">
            <h4 class="card-title">Konu Basligi</h4>
            <div class="form-group">
                <input type="text" class="form-control" asp-for="Subject" aria-describedby="Konu Basligi" placeholder="Konu Basligi">
            </div>

            <h4 class="card-title">Mesaj</h4>
            <div class="form-group">
                <textarea id="editor1" name="Slider">
                    @Html.Raw(Model.Body)
                </textarea>
            </div>

            <h4 class="card-title">Gonderilecek Dosyalar</h4>
            <div class="input-group mb-3">
                <div class="custom-file">
                    <input type="file" asp-for="File" class="custom-file-input">
                    <label class="custom-file-label">Dosya Seç</label>
                </div>
            </div>


            <center><button class="btn btn-success" type="submit">Gonder</button></center>
        </form>

        <button id="MailButton" type="button"  data-toggle="modal" data-target="#mail-modal" class="btn btn-success btn-rounded"><i class="fas fa-plus"></i> Mail Adresi Ekle </button>

        <table class="table table-striped mt-3">
            <thead>
                <tr>
                    <th>Mail Adresi</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Emails)
                {
                    <tr>
                        <td>@item.EmailAddress</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

</div>

@section Scripts{
    <script>
        function BilgilendirmeEkle() {

            var mail = $("#mail").val();

            $.ajax({
                type: "GET",
                url: "/Admin/Home/BilgilendirmeEkle?mail=" + mail,
                success: function (response) {
                    toastr.success(response);
                    location.reload();
                },
                failure: function (response) {
                    toastr.error('Sunucu ile bağlantı kurulamadı.');
                },
                error: function (response) {
                    toastr.error('Sunucu ile bağlantı kurulamadı.');
                }
            });
        }
    </script>
}